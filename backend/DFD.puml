@startuml SI_Bimbingan_Konseling_DFD

!theme plain
skinparam backgroundColor #FEFEFE
skinparam defaultFontSize 11

skinparam actor {
  BackgroundColor LightBlue
  BorderColor Black
}

skinparam database {
  BackgroundColor LightYellow
  BorderColor Black
}

skinparam rectangle {
  BackgroundColor LightGreen
  BorderColor Black
  RoundCorner 10
}

skinparam cloud {
  BackgroundColor LightPink
  BorderColor Black
}

package "Context Diagram (Level 0)" {
  
  actor "Admin" as admin0
  actor "Guru BK" as guru0
  actor "Siswa" as siswa0
  actor "Orang Tua" as ortu0
  
  cloud "Sistem Informasi\nBimbingan Konseling\nSMK N 1 Kupang" as sistem0
  
  admin0 --> sistem0 : Login, Kelola Data Master
  sistem0 --> admin0 : Laporan, Dashboard
  
  guru0 --> sistem0 : Login, Input Pelanggaran,\nBeri Tindakan
  sistem0 --> guru0 : Data Siswa, Laporan,\nTanggapan Ortu
  
  siswa0 --> sistem0 : Login, Lihat Pelanggaran
  sistem0 --> siswa0 : Riwayat Pelanggaran,\nPoin, Tindakan
  
  ortu0 --> sistem0 : Login, Beri Tanggapan
  sistem0 --> ortu0 : Laporan Pelanggaran Anak,\nNotifikasi
}

newpage

package "Level 1: Main Processes" {
  
  actor "Admin" as admin1
  actor "Guru BK" as guru1
  actor "Siswa" as siswa1
  actor "Orang Tua" as ortu1
  
  database "D1: User Database" as db1
  database "D2: Master Data" as db2
  database "D3: Pelanggaran" as db3
  database "D4: Tanggapan & Tindakan" as db4
  database "D5: Laporan" as db5
  
  rectangle "1.0\nManajemen\nAutentikasi" as p1
  rectangle "2.0\nManajemen\nData Master" as p2
  rectangle "3.0\nPencatatan\nPelanggaran" as p3
  rectangle "4.0\nManajemen\nTanggapan & Tindakan" as p4
  rectangle "5.0\nPelaporan &\nAnalitik" as p5
  rectangle "6.0\nNotifikasi\nReal-time" as p6
  
  admin1 --> p1 : Credentials
  guru1 --> p1 : Credentials
  siswa1 --> p1 : Credentials
  ortu1 --> p1 : Credentials
  p1 --> db1 : Verify User
  db1 --> p1 : User Data
  p1 --> admin1 : Access Token
  p1 --> guru1 : Access Token
  p1 --> siswa1 : Access Token
  p1 --> ortu1 : Access Token
  
  admin1 --> p2 : CRUD Master Data
  p2 --> db2 : Store/Update Data
  db2 --> p2 : Master Data
  p2 --> admin1 : Confirmation
  
  guru1 --> p3 : Input Pelanggaran
  p3 --> db2 : Get Jenis Pelanggaran,\nData Siswa
  p3 --> db3 : Store Pelanggaran
  db3 --> p3 : Pelanggaran Data
  p3 --> guru1 : Confirmation
  p3 --> p6 : Trigger Notification
  
  ortu1 --> p4 : Beri Tanggapan
  guru1 --> p4 : Beri Tindakan
  p4 --> db3 : Get Pelanggaran
  p4 --> db4 : Store Tanggapan/Tindakan
  db4 --> p4 : Data Tanggapan/Tindakan
  p4 --> ortu1 : Confirmation
  p4 --> guru1 : Confirmation
  p4 --> p6 : Trigger Notification
  
  admin1 --> p5 : Request Laporan
  guru1 --> p5 : Request Laporan
  siswa1 --> p5 : Request Riwayat
  ortu1 --> p5 : Request Laporan Anak
  p5 --> db3 : Get Pelanggaran Data
  p5 --> db4 : Get Tanggapan/Tindakan
  p5 --> db5 : Store/Get Laporan
  p5 --> admin1 : Laporan
  p5 --> guru1 : Laporan
  p5 --> siswa1 : Riwayat
  p5 --> ortu1 : Laporan Anak
  
  p6 --> ortu1 : Notifikasi Pelanggaran
  p6 --> guru1 : Notifikasi Tanggapan
  p6 --> siswa1 : Notifikasi Tindakan
}

newpage

package "Level 2: Authentication Process (1.0)" {
  
  actor "User" as user2
  
  rectangle "1.1\nValidasi\nCredentials" as p11
  rectangle "1.2\nVerifikasi\nPassword" as p12
  rectangle "1.3\nGenerate\nJWT Token" as p13
  rectangle "1.4\nCreate\nSession" as p14
  
  database "D1.1: Users" as db11
  database "D1.2: Sessions" as db12
  
  user2 --> p11 : Email & Password
  p11 --> p12 : Validated Input
  p12 --> db11 : Check User
  db11 --> p12 : User Data & Hash
  p12 --> p13 : Verified User
  p13 --> p14 : JWT Token
  p14 --> db12 : Store Session
  p14 --> user2 : Access Token
}

newpage

package "Level 2: Violation Recording (3.0)" {
  
  actor "Guru BK" as guru2
  
  rectangle "3.1\nInput Data\nPelanggaran" as p31
  rectangle "3.2\nValidasi\nData" as p32
  rectangle "3.3\nHitung\nPoin" as p33
  rectangle "3.4\nSimpan\nPelanggaran" as p34
  rectangle "3.5\nUpdate\nTotal Poin Siswa" as p35
  
  database "D2.1: Siswa" as db21
  database "D2.2: Jenis Pelanggaran" as db22
  database "D3.1: Pelanggaran Siswa" as db31
  
  guru2 --> p31 : Form Pelanggaran
  p31 --> p32 : Raw Data
  p32 --> db21 : Verify Siswa
  p32 --> db22 : Get Jenis & Poin
  db21 --> p32 : Siswa Valid
  db22 --> p32 : Poin Pelanggaran
  p32 --> p33 : Validated Data
  p33 --> p34 : Data + Poin
  p34 --> db31 : Store Record
  p34 --> p35 : Update Signal
  p35 --> db21 : Update Total Poin
  p35 --> guru2 : Success Confirmation
}

newpage

package "Level 2: Response & Action Process (4.0)" {
  
  actor "Orang Tua" as ortu2
  actor "Guru BK" as guru2b
  
  rectangle "4.1\nBeri Tanggapan\nOrang Tua" as p41
  rectangle "4.2\nBeri Tindakan\nSekolah" as p42
  rectangle "4.3\nUpdate Status\nKonseling" as p43
  rectangle "4.4\nValidasi &\nSimpan" as p44
  
  database "D3.1: Pelanggaran" as db31b
  database "D4.1: Tanggapan" as db41
  database "D4.2: Tindakan" as db42
  
  ortu2 --> p41 : Isi Tanggapan
  guru2b --> p42 : Isi Tindakan
  p41 --> p44 : Tanggapan Data
  p42 --> p44 : Tindakan Data
  p44 --> db31b : Get Pelanggaran
  p44 --> db41 : Store Tanggapan
  p44 --> db42 : Store Tindakan
  p44 --> p43 : Update Signal
  p43 --> db31b : Update Status
  p43 --> ortu2 : Confirmation
  p43 --> guru2b : Confirmation
}

newpage

package "Level 2: Reporting Process (5.0)" {
  
  actor "User" as user5
  
  rectangle "5.1\nTerima Request\nLaporan" as p51
  rectangle "5.2\nFilter &\nKumpulkan Data" as p52
  rectangle "5.3\nProses\nAnalitik" as p53
  rectangle "5.4\nGenerate\nReport" as p54
  rectangle "5.5\nExport\n(Excel/PDF)" as p55
  
  database "D3: All Violations" as db3a
  database "D4: Responses & Actions" as db4a
  database "D5: Reports Cache" as db5a
  
  user5 --> p51 : Filter Criteria
  p51 --> p52 : Query Params
  p52 --> db3a : Fetch Violations
  p52 --> db4a : Fetch Responses/Actions
  db3a --> p52 : Violation Data
  db4a --> p52 : Response/Action Data
  p52 --> p53 : Aggregated Data
  p53 --> p54 : Analytics Results
  p54 --> db5a : Cache Report
  p54 --> p55 : Report Data
  p55 --> user5 : Excel/PDF File
}

newpage

package "Level 2: Notification System (6.0)" {
  
  rectangle "6.1\nDetect\nEvent" as p61
  rectangle "6.2\nIdentify\nRecipients" as p62
  rectangle "6.3\nCreate\nNotification" as p63
  rectangle "6.4\nSend Email\n(Optional)" as p64
  rectangle "6.5\nSend WebSocket\nNotification" as p65
  
  database "D6.1: Notifications" as db61
  database "D6.2: User Preferences" as db62
  cloud "Email Service" as email
  cloud "WebSocket Server" as ws
  
  actor "User Client" as userclient
  
  p61 --> p62 : Event Data
  p62 --> db62 : Get User Preferences
  db62 --> p62 : Notification Settings
  p62 --> p63 : Recipient List
  p63 --> db61 : Store Notification
  p63 --> p64 : Email Data
  p63 --> p65 : Socket Data
  p64 --> email : Send Email
  p65 --> ws : Emit Event
  ws --> userclient : Real-time Update
}

legend right
  **KONVENSI DFD:**
  
  **External Entity** (Actor)
  • Sumber atau tujuan data
  • Berada di luar sistem
  
  **Process** (Rectangle with number)
  • Transformasi data
  • Numbered: X.Y
  
  **Data Store** (Database)
  • Penyimpanan data
  • Prefix D: Database
  
  **Data Flow** (Arrow)
  • Aliran data antar komponen
  • Labeled dengan jenis data
  
  **LEVEL:**
  • Level 0: Context (Overview)
  • Level 1: Main Processes
  • Level 2: Detailed Processes
end legend

@enduml